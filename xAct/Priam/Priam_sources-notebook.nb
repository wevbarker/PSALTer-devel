(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13333,        356]
NotebookOptionsPosition[     11434,        318]
NotebookOutlinePosition[     12007,        338]
CellTagsIndexPosition[     11964,        335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Department of Physics", "Department",
 CellChangeTimes->{{3.864792470280526*^9, 
  3.8647924819956284`*^9}},ExpressionUUID->"0bc37bb9-fabf-4cb3-8ebb-\
3d150bf7ee54"],

Cell[CellGroupData[{

Cell["Priam", "Title",
 CellChangeTimes->{{3.856165344530184*^9, 3.856165360586437*^9}, {
  3.856592043342741*^9, 3.8565920465891027`*^9}, {3.860570667239029*^9, 
  3.860570670134791*^9}, {3.864550710189993*^9, 3.864550718430193*^9}, {
  3.8647200714534063`*^9, 3.864720142813765*^9}, {3.864723307218957*^9, 
  3.864723307898204*^9}, {3.8648044896338873`*^9, 3.86480450367338*^9}, {
  3.866621828197319*^9, 3.86662183424467*^9}, {3.867823383414276*^9, 
  3.867823385339759*^9}, {3.870102900359118*^9, 
  3.87010290094293*^9}},ExpressionUUID->"77b3805d-060b-4070-8508-\
41576cdf0004"],

Cell["The source file for basic setup", "Subtitle",
 CellChangeTimes->{{3.867831576589563*^9, 3.867831583277936*^9}, {
  3.870162655397043*^9, 
  3.870162658996735*^9}},ExpressionUUID->"fdab78d6-e8ed-4350-a907-\
43be83cbe14c"],

Cell["W. E. V. Barker", "Author",
 CellChangeTimes->{{3.864749323312978*^9, 3.864749328306797*^9}, {
  3.8647926323894053`*^9, 
  3.864792635660534*^9}},ExpressionUUID->"100960d2-4b38-41a5-b137-\
191a74131b9c"],

Cell["Cavendish Astrophysics Group, University of Cambridge", "Institution",
 CellChangeTimes->{{3.8647496067443113`*^9, 
  3.864749632519373*^9}},ExpressionUUID->"7b839eae-4784-493d-b59a-\
51bcafa75e59"],

Cell["Kavli Institute for Cosmology, Cambridge", "Institution",
 CellChangeTimes->{{3.864792539783351*^9, 
  3.864792546672456*^9}},ExpressionUUID->"0ac373f1-6b62-4d29-9854-\
7937575c2f2d"],

Cell["\<\
This package performs the propagator analysis of gravitational gauge theories.\
\>", "Abstract",
 CellChangeTimes->{{3.864792321119171*^9, 3.864792323980362*^9}, {
   3.864792550694606*^9, 3.8647926003744*^9}, {3.864792640417905*^9, 
   3.864792648429236*^9}, {3.8647926787887573`*^9, 3.864792693781187*^9}, {
   3.86480450919359*^9, 3.864804522062533*^9}, {3.864804622538254*^9, 
   3.8648046286692057`*^9}, {3.866621840134227*^9, 3.866621864012751*^9}, {
   3.867823397643692*^9, 3.8678234197877693`*^9}, 
   3.870102908695979*^9},ExpressionUUID->"0a578ac9-1a36-42ab-a8de-\
2ddac1efbc33"],

Cell[CellGroupData[{

Cell["Momentum", "Section",
 CellChangeTimes->{{3.868625718008383*^9, 3.8686257214810143`*^9}, {
  3.87010291444171*^9, 
  3.87010291567078*^9}},ExpressionUUID->"067c87db-b8e3-4967-922b-\
0bb162044858"],

Cell["A constant we use to label the modulus of the momentum.", "Text",
 CellChangeTimes->{{3.863596245261463*^9, 3.863596267797423*^9}, 
   3.864716132541696*^9},ExpressionUUID->"33b5d197-c404-4a99-92bc-\
0a2a1aaef946"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PSymb", "=", "\"\<\[ScriptK]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", 
   RowBox[{"Def", ",", 
    RowBox[{"PrintAs", "\[Rule]", "PSymb"}]}], "]"}], ";"}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.860592993327661*^9, 3.860593056198492*^9}, {
  3.8605931345663424`*^9, 3.860593164549306*^9}, {3.860593278974008*^9, 
  3.860593279180448*^9}, {3.860594006477219*^9, 3.86059403768804*^9}, {
  3.86059590848214*^9, 3.860595910666298*^9}, {3.863458493366744*^9, 
  3.863458501367938*^9}, {3.864197177992216*^9, 3.864197188264058*^9}, {
  3.8701030204406853`*^9, 
  3.8701030315597963`*^9}},ExpressionUUID->"756cb734-b2cf-4b22-b054-\
974409048617"],

Cell["The momentum vector.", "Text",
 CellChangeTimes->{{3.86359627356537*^9, 3.8635962777729673`*^9}, 
   3.864716142491022*^9},ExpressionUUID->"5378ef92-2cbb-4aa1-bc74-\
e327c78f7104"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"P", "[", "i", "]"}], ",", "M4", ",", 
    RowBox[{"PrintAs", "\[Rule]", "PSymb"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AutomaticRules", "[", 
   RowBox[{"P", ",", 
    RowBox[{"MakeRule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"CD", "[", 
          RowBox[{"-", "a"}], "]"}], "[", 
         RowBox[{"P", "[", 
          RowBox[{"-", "b"}], "]"}], "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
      RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToV", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"-", "i"}], "]"}], ",", 
       RowBox[{"Def", " ", 
        RowBox[{"V", "[", 
         RowBox[{"-", "i"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToP", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V", "[", 
        RowBox[{"-", "i"}], "]"}], ",", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"-", "i"}], "]"}], "/", "Def"}]}], "}"}], ",", 
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.860592993327661*^9, 3.860593056198492*^9}, {
  3.8605931345663424`*^9, 3.860593164549306*^9}, {3.860593278974008*^9, 
  3.860593279180448*^9}, {3.860594006477219*^9, 3.86059403768804*^9}, {
  3.86059590848214*^9, 3.8605959606253643`*^9}, {3.863457883672477*^9, 
  3.8634578880826817`*^9}, {3.863458408905295*^9, 3.8634584282357187`*^9}, {
  3.8634585061685047`*^9, 3.863458544719845*^9}, {3.863596228910615*^9, 
  3.863596229908679*^9}, {3.863954543144*^9, 3.8639545580488577`*^9}, {
  3.864197151778009*^9, 3.864197172776391*^9}, {3.870102967921116*^9, 
  3.870102984049223*^9}, {3.8701030168881817`*^9, 
  3.870103034424086*^9}},ExpressionUUID->"60f9b421-2f3f-4ab3-9860-\
35938c330d6b"],

Cell[TextData[{
 "Use the cyclic identity on the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["2", "-"], TraditionalForm]],ExpressionUUID->
  "6ed2a000-e5be-4bd2-92c3-243146cfde41"],
 " terms to reduce to one quadratic term in this sector. We need these rules \
to \[OpenCurlyDoubleQuote]patch\[CloseCurlyDoubleQuote] how HiGGS handles \
this sector, because xAct cannot handle multi-term symmetries."
}], "Text",
 CellChangeTimes->{{3.863596096006381*^9, 3.863596141887021*^9}, {
  3.864717841877577*^9, 
  3.8647178757357693`*^9}},ExpressionUUID->"5365aa92-05ef-4139-84b1-\
5d6d9c72e3ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"PatchA2m", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"AP2m", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "b"}]}], "]"}], 
        RowBox[{"AP2m", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"AP2m", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}]}], "]"}], 
        RowBox[{"AP2m", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatchA2mD1", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"Dagger", "@", 
          RowBox[{"AP2m", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "c"}], ",", 
            RowBox[{"-", "b"}]}], "]"}]}], 
         RowBox[{"AP2m", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], 
         RowBox[{"Dagger", "@", 
          RowBox[{"AP2m", "[", 
           RowBox[{
            RowBox[{"-", "a"}], ",", 
            RowBox[{"-", "b"}], ",", 
            RowBox[{"-", "c"}]}], "]"}]}], 
         RowBox[{"AP2m", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatchA2mD2", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"AP2m", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "c"}], ",", 
           RowBox[{"-", "b"}]}], "]"}], 
         RowBox[{"Dagger", "@", 
          RowBox[{"AP2m", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], 
         RowBox[{"AP2m", "[", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}], ",", 
           RowBox[{"-", "c"}]}], "]"}], 
         RowBox[{"Dagger", "@", 
          RowBox[{"AP2m", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "]"}]}], "}"}], ",", 
     
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PatchSigma2m", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"SigmaP2m", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "c"}], ",", 
          RowBox[{"-", "b"}]}], "]"}], 
        RowBox[{"SigmaP2m", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"SigmaP2m", "[", 
         RowBox[{
          RowBox[{"-", "a"}], ",", 
          RowBox[{"-", "b"}], ",", 
          RowBox[{"-", "c"}]}], "]"}], 
        RowBox[{"SigmaP2m", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "\[Rule]", "All"}], ",", 
     RowBox[{"ContractMetrics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Patch2m", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "PatchA2m", ",", "PatchA2mD1", ",", "PatchA2mD2", ",", "PatchSigma2m"}], 
    "]"}]}], ";"}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{{3.863545115836523*^9, 3.863545182752758*^9}, {
  3.863585662304422*^9, 3.863585671502878*^9}, {3.863596147392112*^9, 
  3.863596195622224*^9}, {3.864550780950371*^9, 3.86455086316796*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"6e0f8afe-dbde-4931-8b29-d80eb6a8fd3b"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
ScreenStyleEnvironment->"Slideshow Working",
WindowSize->{1440., 860.25},
WindowMargins->{{Automatic, 810}, {Automatic, 19.5}},
TaggingRules-><|
 "TryRealOnly" -> False, "PresenterSettings" -> <|"ShowSlideBreaks" -> True|>|>,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Script.nb",
ExpressionUUID->"f0892181-16ac-4a5b-9eda-c744fca94a50"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 171, 3, 23, "Department",ExpressionUUID->"0bc37bb9-fabf-4cb3-8ebb-3d150bf7ee54"],
Cell[CellGroupData[{
Cell[754, 27, 583, 9, 98, "Title",ExpressionUUID->"77b3805d-060b-4070-8508-41576cdf0004"],
Cell[1340, 38, 226, 4, 53, "Subtitle",ExpressionUUID->"fdab78d6-e8ed-4350-a907-43be83cbe14c"],
Cell[1569, 44, 210, 4, 32, "Author",ExpressionUUID->"100960d2-4b38-41a5-b137-191a74131b9c"],
Cell[1782, 50, 204, 3, 23, "Institution",ExpressionUUID->"7b839eae-4784-493d-b59a-51bcafa75e59"],
Cell[1989, 55, 189, 3, 23, "Institution",ExpressionUUID->"0ac373f1-6b62-4d29-9854-7937575c2f2d"],
Cell[2181, 60, 600, 10, 62, "Abstract",ExpressionUUID->"0a578ac9-1a36-42ab-a8de-2ddac1efbc33"],
Cell[CellGroupData[{
Cell[2806, 74, 202, 4, 68, "Section",ExpressionUUID->"067c87db-b8e3-4967-922b-0bb162044858"],
Cell[3011, 80, 220, 3, 35, "Text",ExpressionUUID->"33b5d197-c404-4a99-92bc-0a2a1aaef946"],
Cell[3234, 85, 742, 16, 58, "Code",ExpressionUUID->"756cb734-b2cf-4b22-b054-974409048617",
 InitializationCell->True],
Cell[3979, 103, 186, 3, 35, "Text",ExpressionUUID->"5378ef92-2cbb-4aa1-bc74-e327c78f7104"],
Cell[4168, 108, 2284, 61, 103, "Code",ExpressionUUID->"60f9b421-2f3f-4ab3-9860-35938c330d6b",
 InitializationCell->True],
Cell[6455, 171, 592, 13, 35, "Text",ExpressionUUID->"5365aa92-05ef-4139-84b1-5d6d9c72e3ad"],
Cell[7050, 186, 4356, 128, 120, "Code",ExpressionUUID->"6e0f8afe-dbde-4931-8b29-d80eb6a8fd3b",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

